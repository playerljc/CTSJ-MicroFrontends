var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();import React from"react";import Skeleton from"react-loading-skeleton";import Context from"./context";import Util from"./util";import{routerChangeEmitter}from"./emit/emitter";import{ROUTER_CHANGE}from"./emit/actions";function createComponent(r,s){return e=React.Component,__extends(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.history;this.unListen=t.listen(this.onLocationChange);var o,n,i=r.name;window[i]?(null!==(n=window[i])&&void 0!==n&&n.bootstrap({props:this.props,config:r,el:this.el||s,refresh:this.refresh}),null!==(n=null===(o=window[i])||void 0===o?void 0:o.mount())&&void 0!==n&&n.then(function(){e.setState({isReady:!0})})):(o=r.scripts,n=r.links,Util.loadRemoteResource({scripts:o,links:n}).then(function(){var t;null!==(t=window[i])&&void 0!==t&&t.bootstrap({props:e.props,config:r,el:e.el||s,refresh:e.refresh}),null!==(t=null===(t=window[i])||void 0===t?void 0:t.mount())&&void 0!==t&&t.then(function(){e.setState({isReady:!0})})}))},t.prototype.componentDidUpdate=function(t,e,o){this.lock?this.lock=!1:e.isReady===this.state.isReady&&(e=r.name,null!==(e=window[e])&&void 0!==e&&e.update(t,this.props))},t.prototype.componentWillUnmount=function(){this.unListen();var t=r.name;null!==(t=window[t])&&void 0!==t&&t.unmount()},t.prototype.refresh=function(){this.lock=!0,this.forceUpdate()},t.prototype.onLocationChange=function(t){(!this.preChangeLocation||this.preChangeLocation.pathname!==t.pathname)&&(this.preChangeLocation=t,routerChangeEmitter.trigger(ROUTER_CHANGE,t))},t.prototype.render=function(){var e=this,o=r.name,n=this.state.isReady,i=this.props.children;return React.createElement(Context.Consumer,null,function(t){return e.el=t,React.createElement(Context.Provider,{value:null===(t=window[o])||void 0===t?void 0:t.getChild()},n&&window[o]?i:React.createElement(Skeleton,null))})},t;function t(t){t=e.call(this,t)||this;return t.el=null,t.lock=!1,t.preChangeLocation=null,t.state={isReady:!1},t.onLocationChange=t.onLocationChange.bind(t),t.refresh=t.refresh.bind(t),t}var e}export{createComponent};
//# sourceMappingURL=component.js.map
